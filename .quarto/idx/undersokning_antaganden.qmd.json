{"title":"Undersökning av teoretiska antaganden","markdown":{"yaml":{"title":"Undersökning av teoretiska antaganden","format":"pdf"},"headingText":"Problem efter modellering av modell 1.","containsRefs":false,"markdown":"\n\n\nModellen hade problem med att den inte kunde uppskatta två koefficienter:\n\"Coefficients: (2 not defined because of singularities)\".\nDe koefficienter som inte kunde uppskattas var modelC70 och regionÖrebro.\n\nVid försök att köra vif() (ett mått på multikollinearitet) uppstod ett felmeddelande: \"Error in vif.default(model_1): there are aliased coefficients in the model\".\nDet bekräftades genom att köra alias() som visade vilka variabler som var linjärt beroende av andra.\n\nVid inspektion av tränningdatan så framgick att C70 endast innehöll en obeservation vilket gjorde att modellen inte kunde estimera dess effekt. RegionÖrebro däremot hade 32 observationer, men var linjärt beroende av andra prediktorer varpå multikollinearitet uppstod.\n\nEn kontroll visade att C70 endast förekom fyra gånger i datan, vilket inte räckte för att modellen skulle kunna estimera dess effekt. Observationerna togs därför bort.\n\nDen nya modellen tränades om utan felmeddelanden. För att säkerställa att multikollinearitet inte längre var ett problem användes vif(). De justerade VIF-värdena låg samtliga under det kritiska värdet 5, vilket tydde på att multikollinearitet inte var ett problem i den aktuella modellen. Det högsta värdet var 3.73 (year_model) följt av 3.45 (type).\n\n## Undersökning av teoretiska antaganden - Modell 3\nFör att säkerställa att den linjära regressionsmodellen (modell 3, som valts som slutlig modell) var tillförlitlig, behövde vissa teoretiska antaganden vara uppfyllda. Nedan följer en genomgång av dessa antaganden och hur de uppfyllts i modellen.\n\n```{r}\n#| echo: false\n#| results: \"hide\"\n#| warning: false\n#Loading model to be able to work with it\nmodel_3 <- readRDS(\"model/model_3.rds\")\n#Loading traindata\ntrain <- readRDS(\"data/train_ua.rds\")\n```\n\n### Undersökning av linjärt samband mellan $X$ och $Y$\n```{r}\n#| echo: false\n#| warning: false\n#| fig-cap: 'Residualplot som visar ett svagt icke-linjärt mönster men relativt konstant varians längs $x$-axeln.'\n#Checking lon-linear\nplot(predict(model_3), residuals(model_3),\n     main = \"Residualer vs förväntade värden\",\n     xlab = \"Förväntade värden\",\n     ylab = \"Residualer\")\nabline(h = 0, col = \"red\")\n```\n\nI grafen så ser vi att det finns ett svagt böjt mönster. Det kan tyda på ett avsteg från linjärt samband mellan X och Y. Mönstret är dock inte tillräckligt tydligt för att vi skall förkasta antagandet, men är värt att notera.\n\nSamtidigt verkar variansen vara relativt konstant längs x-axeln. Talar för att antagandet om homogen varians (ingen heteroskedasticitet).\n\n### Normalfördelade residualer\n\n```{r}\n#| echo: false\n#| warning: false\n#| fig-cap: 'Observationerna följer normalfördelningen väl kring medelvärdet, men det finns avvikelser i svansarna.'\n# Q-Q-plot för residualer i modell 3\nqqnorm(residuals(model_3), \n       main = \"Q-Q-plott för att undersöka normalfördelning av residualer\",\n       xlab = \"Teoretiska kvantiler\",\n       ylab = \"Urvalskvantiler\"\n       )\nqqline(residuals(model_3), col = \"red\")\n\n```\n\nObservationerna följer normalfördelningen väl kring medelvärdet, men det finns avvikelser i svansarna – särskilt bland höga värden. Detta indikerar att man bör vara försiktig vid prediktion av ovanligt höga bilpriser.\n \n### Korrelerade residualer (tidsberoende)\nEftersom datan inte är tidsserier och varje bil är en fristående observation fanns inget behov av att undersöka tidsberoende residualer.\n\n### Outliers och leverage\n\n```{r}\n#| echo: false\n#| warning: false\n#| fig-cap: \"Leverage-värden för varje observation i modellen.\"\nplot(hatvalues(model_3), \n     main = \"Leverage-värden för varje observation\",\n      xlab = \"Index (observationens plats i datan)\",\n     ylab = \"Leverage-värde (påverkan på modellen)\"     \n     )\n```\n\n```{r}\n#| echo: false\n#| warning: false\nmax(hatvalues(model_3))\ntrain[which.max(hatvalues(model_3)), ]\n```\n\nLeverage-analysen visade att en observation (en hybrid-SUV från 2022 med 350 hk) hade ovanligt stort inflytande på modellen. Då observationen representerar verkliga och möjliga framtida biltyper valdes den ändå att behållas i datan.\n\n### Multikollinearitet\n\n```{r}\n#| echo: false\n#| warning: false\nlibrary(car) # Run to use vif()\nvif(model_3)\n```\n\nAlla prediktorer hade VIF-värden under 3, vilket innebar att det inte fanns någon allvarlig multikollinearitet i modellen.","srcMarkdownNoYaml":"\n\n## Problem efter modellering av modell 1.\n\nModellen hade problem med att den inte kunde uppskatta två koefficienter:\n\"Coefficients: (2 not defined because of singularities)\".\nDe koefficienter som inte kunde uppskattas var modelC70 och regionÖrebro.\n\nVid försök att köra vif() (ett mått på multikollinearitet) uppstod ett felmeddelande: \"Error in vif.default(model_1): there are aliased coefficients in the model\".\nDet bekräftades genom att köra alias() som visade vilka variabler som var linjärt beroende av andra.\n\nVid inspektion av tränningdatan så framgick att C70 endast innehöll en obeservation vilket gjorde att modellen inte kunde estimera dess effekt. RegionÖrebro däremot hade 32 observationer, men var linjärt beroende av andra prediktorer varpå multikollinearitet uppstod.\n\nEn kontroll visade att C70 endast förekom fyra gånger i datan, vilket inte räckte för att modellen skulle kunna estimera dess effekt. Observationerna togs därför bort.\n\nDen nya modellen tränades om utan felmeddelanden. För att säkerställa att multikollinearitet inte längre var ett problem användes vif(). De justerade VIF-värdena låg samtliga under det kritiska värdet 5, vilket tydde på att multikollinearitet inte var ett problem i den aktuella modellen. Det högsta värdet var 3.73 (year_model) följt av 3.45 (type).\n\n## Undersökning av teoretiska antaganden - Modell 3\nFör att säkerställa att den linjära regressionsmodellen (modell 3, som valts som slutlig modell) var tillförlitlig, behövde vissa teoretiska antaganden vara uppfyllda. Nedan följer en genomgång av dessa antaganden och hur de uppfyllts i modellen.\n\n```{r}\n#| echo: false\n#| results: \"hide\"\n#| warning: false\n#Loading model to be able to work with it\nmodel_3 <- readRDS(\"model/model_3.rds\")\n#Loading traindata\ntrain <- readRDS(\"data/train_ua.rds\")\n```\n\n### Undersökning av linjärt samband mellan $X$ och $Y$\n```{r}\n#| echo: false\n#| warning: false\n#| fig-cap: 'Residualplot som visar ett svagt icke-linjärt mönster men relativt konstant varians längs $x$-axeln.'\n#Checking lon-linear\nplot(predict(model_3), residuals(model_3),\n     main = \"Residualer vs förväntade värden\",\n     xlab = \"Förväntade värden\",\n     ylab = \"Residualer\")\nabline(h = 0, col = \"red\")\n```\n\nI grafen så ser vi att det finns ett svagt böjt mönster. Det kan tyda på ett avsteg från linjärt samband mellan X och Y. Mönstret är dock inte tillräckligt tydligt för att vi skall förkasta antagandet, men är värt att notera.\n\nSamtidigt verkar variansen vara relativt konstant längs x-axeln. Talar för att antagandet om homogen varians (ingen heteroskedasticitet).\n\n### Normalfördelade residualer\n\n```{r}\n#| echo: false\n#| warning: false\n#| fig-cap: 'Observationerna följer normalfördelningen väl kring medelvärdet, men det finns avvikelser i svansarna.'\n# Q-Q-plot för residualer i modell 3\nqqnorm(residuals(model_3), \n       main = \"Q-Q-plott för att undersöka normalfördelning av residualer\",\n       xlab = \"Teoretiska kvantiler\",\n       ylab = \"Urvalskvantiler\"\n       )\nqqline(residuals(model_3), col = \"red\")\n\n```\n\nObservationerna följer normalfördelningen väl kring medelvärdet, men det finns avvikelser i svansarna – särskilt bland höga värden. Detta indikerar att man bör vara försiktig vid prediktion av ovanligt höga bilpriser.\n \n### Korrelerade residualer (tidsberoende)\nEftersom datan inte är tidsserier och varje bil är en fristående observation fanns inget behov av att undersöka tidsberoende residualer.\n\n### Outliers och leverage\n\n```{r}\n#| echo: false\n#| warning: false\n#| fig-cap: \"Leverage-värden för varje observation i modellen.\"\nplot(hatvalues(model_3), \n     main = \"Leverage-värden för varje observation\",\n      xlab = \"Index (observationens plats i datan)\",\n     ylab = \"Leverage-värde (påverkan på modellen)\"     \n     )\n```\n\n```{r}\n#| echo: false\n#| warning: false\nmax(hatvalues(model_3))\ntrain[which.max(hatvalues(model_3)), ]\n```\n\nLeverage-analysen visade att en observation (en hybrid-SUV från 2022 med 350 hk) hade ovanligt stort inflytande på modellen. Då observationen representerar verkliga och möjliga framtida biltyper valdes den ändå att behållas i datan.\n\n### Multikollinearitet\n\n```{r}\n#| echo: false\n#| warning: false\nlibrary(car) # Run to use vif()\nvif(model_3)\n```\n\nAlla prediktorer hade VIF-värden under 3, vilket innebar att det inte fanns någon allvarlig multikollinearitet i modellen."},"formats":{"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":true,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"number-sections":true,"include-in-header":["preamble.tex"],"output-file":"undersokning_antaganden.pdf"},"language":{"toc-title-document":"Innehållsförteckning","toc-title-website":"På denna sida","related-formats-title":"Andra Format","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Källa","other-links-title":"Övriga länkar","code-links-title":"Kodlänkar","launch-dev-container-title":"Starta Dev Container","launch-binder-title":"Starta Binder","article-notebook-label":"Artikelanteckningsbok","notebook-preview-download":"Ladda ner anteckningsbok","notebook-preview-download-src":"Ladda ner källkod","notebook-preview-back":"Tillbaka till artikel","manuscript-meca-bundle":"MECA-arkiv","section-title-abstract":"Sammanfattning","section-title-appendices":"Bilagor","section-title-footnotes":"Fotnot","section-title-references":"Referenser","section-title-reuse":"Återanvänd","section-title-copyright":"Copyright","section-title-citation":"Citat","appendix-attribution-cite-as":"Hänvisa till detta arbete som:","appendix-attribution-bibtex":"BibTeX hänvisning:","appendix-view-license":"Visa Licens","title-block-author-single":"Författare","title-block-author-plural":"Författare","title-block-affiliation-single":"Anknuten","title-block-affiliation-plural":"Anknutna","title-block-published":"Utgiven","title-block-modified":"Ändrad","title-block-keywords":"Nyckelord","callout-tip-title":"Tips","callout-note-title":"Notera","callout-warning-title":"Varning","callout-important-title":"Viktigt","callout-caution-title":"Caution","code-summary":"Kod","code-tools-menu-caption":"Kod","code-tools-show-all-code":"Visa all kod","code-tools-hide-all-code":"Göm all kod","code-tools-view-source":"Visa källa","code-tools-source-code":"Källkod","tools-share":"Share","tools-download":"Download","code-line":"Rad","code-lines":"Rader","copy-button-tooltip":"Kopiera till urklipp","copy-button-tooltip-success":"Kopierat!","repo-action-links-edit":"Redigera denna sida","repo-action-links-source":"Visa källa","repo-action-links-issue":"Rapportera ett problem","back-to-top":"Tillbaka till toppen","search-no-results-text":"Inget resultat","search-matching-documents-text":"matchande dokument","search-copy-link-title":"Kopiera länk för att söka","search-hide-matches-text":"Göm ytterligare resultat","search-more-match-text":"annat resultat i detta dokument","search-more-matches-text":"fler resultat i detta dokument","search-clear-button-title":"Rensa","search-text-placeholder":"","search-detached-cancel-button-title":"Avbryt","search-submit-button-title":"Verkställ","search-label":"Sök","toggle-section":"Skifta sektion","toggle-sidebar":"Skifta sidonavigering","toggle-dark-mode":"Skifta mörkt läge","toggle-reader-mode":"Skifta läsläge","toggle-navigation":"Skifta navigering","crossref-fig-title":"Figur","crossref-tbl-title":"Tabell","crossref-lst-title":"Lista","crossref-thm-title":"Teorem","crossref-lem-title":"Lemma","crossref-cor-title":"Följdsats","crossref-prp-title":"Påstående","crossref-cnj-title":"Förmodan","crossref-def-title":"Definition","crossref-exm-title":"Exempel","crossref-exr-title":"Uppgift","crossref-ch-prefix":"Kapitel","crossref-apx-prefix":"Bilaga","crossref-sec-prefix":"Avsnitt","crossref-eq-prefix":"Ekvation","crossref-lof-title":"Figurförteckning","crossref-lot-title":"Tabellförteckning","crossref-lol-title":"Listförteckning","environment-proof-title":"Bevis","environment-remark-title":"Anmärkning","environment-solution-title":"Lösning","listing-page-order-by":"Sorterat efter","listing-page-order-by-default":"Standard","listing-page-order-by-date-asc":"Äldst","listing-page-order-by-date-desc":"Nyast","listing-page-order-by-number-desc":"Högt till lågt","listing-page-order-by-number-asc":"Lågt till högt","listing-page-field-date":"Datum","listing-page-field-title":"Titel","listing-page-field-description":"Beskrivning","listing-page-field-author":"Författare","listing-page-field-filename":"Filnamn","listing-page-field-filemodified":"Ändrad","listing-page-field-subtitle":"Undertitel","listing-page-field-readingtime":"Lästid","listing-page-field-wordcount":"Ordmätning","listing-page-field-categories":"Kategorier","listing-page-minutes-compact":"{0} min","listing-page-category-all":"Allt","listing-page-no-matches":"Inget resultat","listing-page-words":"{0} ord","listing-page-filter":"Filter","draft":"Utkast"},"metadata":{"block-headings":true,"lang":"sv","title":"Undersökning av teoretiska antaganden"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["pdf"]}